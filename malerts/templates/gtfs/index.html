{% extends "base.html" %}
{% load verbatim %}
{% load mustache %}
{% load straight_include %}

{% block extrajs %}
	<script type="text/javascript">
		(function() {
			"use strict"
			var Alert =  Backbone.Model.extend({
				defaults : {}
			});
			var AlertCollection = Backbone.Collection.extend({
				model: Alert,
				url : "http://alerts.metro.net/api/v1/alert/",
				parse: function(response) {
					return response.objects;
				}
			});
		}) ();
	</script>
	<script type="text/javascript">
		window.AlertView = Backbone.View.extend({
		  tagName: 'li',
		  className: 'alert',
		 
		  render: function(){
			  $(this.el).html(ich.alertTemplate(this.model.toJSON()));
			  return this;
		  }                                        
		});
	</script>
	<script>
		ALERT_API = "{% url api_dispatch_list api_name="v1" resource_name="alert" %}";
		{% if data %}
			app = {loaded: true};
		{% endif %}
	</script>
	
    <script type="text/html" id="listApp">
      {% straight_include "listApp.mustache" %}
    </script>
    <script type="text/html" id="detailApp">
      {% straight_include "detailApp.mustache" %}
    </script>
{% endblock %}

{% block extracss %}
{% endblock %}


{% block maincontent %}
	<!-- gtfs/index.html -->
	{% verbatim %}
	<script type="text/html" id="alertTemplate">
	  <a class="header_text">{{header_text}}</a>
	  <p class="message">
		{{url}}
	  </p>
	  <abbr class="timestamp">{{start}}</abbr>
	</script>
	{% endverbatim %}

	<div id="app">
      {% if data %}
      	  {% autoescape off %}
	    	  {% mustache "detailApp" data %}
    	  {% endautoescape %}
      {% endif %}
    </div>
    
{% endblock %}
